---
title: "[CJOlivenetworks] CGV Fast Order 시스템 인프라 구축 2. Terraform / Terraform Cloud 를 활용한 Cloud Infra 구축 자동화"
categories:
  - Cloud-Wave-Project
tags:
  - Cloud-Wave-Project
toc: true
toc_sticky: true
toc_label: "Carefree to See"
header:
   teaser: "/assets/images/CloudWave/project/terraform2.png"
---
<!-- Created by Chae Seung Min - CarefreeLife
Visit my Programming blog: https://carefreelife98.github.io --> 
---

# Terraform 을 통한 Cloud Infra 자동화

<img src="/assets/images/CloudWave/project/terraform2.png" alt="terraform2_Procdess" width="100%" min-width="200px" itemprop="image"><br>[사진 출처: Hashicorp](https://www.hashicorp.com/products/terraform)<br>

- IaC(Infrastructure as Code)는 수동 작업 대비 일관성 유지, 재사용성, 자동화 측면 향상.
  - 테라폼은 cloudformation, pulumi와 같은 IaC 방법론을 실현하는 도구 중 하나.
    - IaC 이전의 Cloud Infra 관리는 웹 콘솔이 주류로 사용.
    - 콘솔로도 작업은 가능하지만 대규모 / 반복적 작업을 수행하는 경우 매우 비효율적.
- 가령 필요에 따라 dev 환경의 생성 및 제거 작업이 반복적으로 필요한 경우
  - 해당 dev VPC에는 각 3개의 퍼블릭/프라이빗 서브넷을 갖고, 퍼블릭엔 서비스 확인을 위한 접근용 ALB / 프라이빗엔 WEB, WAS 서버 및 RDS가 구성되어야 하고, 각 ALB와 EC2에 대하여 쉬운 접근을 위해 Route53 도메인을 붙이는 것이 필요 조건.
  - 해당 과정을 수동으로 진행한다면 리소스 tag 규칙등의 과정에서 입력 실수로 인해 누락/오입력이 발생하고, 일관성의 훼손 가능성 증가.
  - 생성 및 재생성 과정을 일일히 생성하면 시간도 오래 걸리고, 비효율적이다. 그러나 코드로 구성되어, 필요할때마다 복제하고 재생성 한다면 매우 효율적.

<br>

<img src="/assets/images/CloudWave/project/terraformCode.png" alt="terraformCode_Procdess" width="100%" min-width="200px" itemprop="image"><br>`작성한 Terraform code - main.tf 중 일부분.`<br>

<br><br>

# Terraform 기본 Command

```shell
# 현재 디렉토리 초기화
$ terraform init

# Terraform 이 어떤 작업을 하게 될 지 Dry-Run
$ terraform plan

# 해당 코드를 apply하여 적용하고 Build.
$ terraform apply

# Terraform 으로 구축된 것 삭제
$ terraform destroy

# state file 새로고침
$ terraform refresh

# Terraform output 보기
$ terraform output

# Dot-formatted graph 생성
$ terraform graph
```

<br><br>

# tfenv

1. tfenv clone 설치

```bash
$ git clone https://github.com/tfutils/tfenv.git ~/.tfenv
```

1. Terraform 특정 버전 설치

   ![스크린샷 2023-08-07 오전 10.26.17.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/03fc36b9-3a0a-4ca2-94a8-2944db85efc6/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-08-07_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.26.17.png)


1. Terraform 특정 버전 설치 확인

    ```bash
    $ tfenv list
    ```

   ![스크린샷 2023-08-07 오전 10.27.27.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/417b15f8-218d-4837-99d4-5ddf3003cf2d/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-08-07_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.27.27.png)


1. 특정 버전의 Terraform 사용하기

    ```bash
    $ tfenv use (버젼 명시)
    $ terraform --version
    ```

   ![스크린샷 2023-08-07 오전 10.29.22.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1652a812-07fd-4c09-9d29-d0297c3c1077/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-08-07_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.29.22.png)


1. 특정 버전의 Terraform 삭제하기

    ```bash
    $ tfenv uninstall (버전 명시)
    ```

   ![스크린샷 2023-08-07 오전 10.37.11.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/09d810aa-7a2b-4711-b558-542a02b11788/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-08-07_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.37.11.png)




<img src="/assets/images/CloudWave/project/naming.png" alt="naming_Procdess" width="100%" min-width="200px" itemprop="image"><br>`(주)구름 건설의 Naming Rule`<br>


[//]: # (<span style="color:green">``</span>)

[//]: # ()
[//]: # ({: .notice--danger})

[//]: # ({: style="text-align: center;"})

[//]: # ()
[//]: # (<details>)

[//]: # (<summary><span style="color:blue">&#40;클릭&#41;</span></summary>)

[//]: # (<div markdown="1">       )

[//]: # ()
[//]: # (</div>)

[//]: # (</details>)


<br><br>

허용 가능한 만큼의 학습 내용을 복습 겸 이곳에 포스팅 해보려고 합니다.<br><br>
혹시 이해가 안가거나 추가적인 설명이 필요한 부분, 오류 등의 피드백은 언제든지 환영합니다!<br><br>
긴 글 읽어주셔서 감사합니다. 포스팅을 마칩니다.<br>
{: .notice--success}
{: style="text-align: center;"}

<br><br>

[처음으로~](#){: .btn .btn--primary }

### Task Lists

>

- [x] 
- [x] 
- [x] 
- [x] 
- [x] 
- [x] 
- [x] 
- [x] 
- [x] 